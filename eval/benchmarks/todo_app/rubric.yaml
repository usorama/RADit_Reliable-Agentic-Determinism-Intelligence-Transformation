version: "1.0"
benchmark_id: "todo_app"
description: "Scoring rubric for ToDo App benchmark evaluation"

scoring:
  task_decomposition:
    weight: 0.30
    description: "Measures quality of PRD to task breakdown"
    criteria:
      - name: task_count_accuracy
        weight: 0.25
        tolerance: 0.20
        expected_range: [12, 15]
        description: "Task count should be 12-15 tasks"

      - name: dependency_correctness
        weight: 0.40
        description: "Critical dependencies correctly identified"
        required_dependencies:
          - from: "models"
            to: "repository"
          - from: "repository"
            to: "service"
          - from: "exceptions"
            to: "service"

      - name: priority_alignment
        weight: 0.35
        description: "Priority distribution matches requirements"
        expected_distribution:
          P0: 9   # Core CRUD + setup + verification
          P1: 2   # Reopen, view details
          P2: 1   # Due date

  code_quality:
    weight: 0.40
    description: "Measures quality of generated code"
    criteria:
      - name: test_coverage
        weight: 0.30
        threshold: 0.80

      - name: lint_pass
        weight: 0.25
        threshold: 1.00

      - name: type_safety
        weight: 0.25
        threshold: 1.00

      - name: pattern_adherence
        weight: 0.20
        expected_patterns:
          - "Pydantic models for data validation"
          - "Repository pattern for data access"
          - "Service layer for business logic"
          - "Custom exceptions for error handling"
          - "Type hints on all public functions"

  similarity:
    weight: 0.30
    description: "Measures output similarity to golden references"
    criteria:
      - name: semantic_similarity
        weight: 0.50
        threshold: 0.85
        model: "text-embedding-3-small"

      - name: structural_similarity
        weight: 0.50
        threshold: 0.80

pass_criteria:
  required:
    - task_decomposition_score: ">= 0.70"
    - code_quality_score: ">= 0.80"
    - all_tests_pass: true
    - crud_operations_work: true

expected_outputs:
  files:
    - "src/todo/__init__.py"
    - "src/todo/models.py"
    - "src/todo/exceptions.py"
    - "src/todo/repository.py"
    - "src/todo/service.py"
    - "tests/test_todo/__init__.py"
    - "tests/test_todo/test_models.py"
    - "tests/test_todo/test_repository.py"
    - "tests/test_todo/test_service.py"

  classes:
    models:
      - name: "TaskStatus"
        type: "Enum"
        values: ["PENDING", "COMPLETED"]
      - name: "Task"
        type: "BaseModel"
        fields: ["id", "title", "description", "status", "created_at", "updated_at", "completed_at"]

    repository:
      - name: "TaskRepository"
        methods: ["save", "find_by_id", "find_all", "delete"]

    service:
      - name: "TodoService"
        methods: ["create_task", "get_task", "list_tasks", "update_task", "complete_task", "delete_task", "reopen_task"]

    exceptions:
      - name: "TaskNotFoundError"
        base: "Exception"
      - name: "InvalidTaskError"
        base: "Exception"
      - name: "TaskAlreadyCompletedError"
        base: "Exception"

test_requirements:
  minimum_test_count: 25
  required_test_categories:
    - "test_task_model_creation"
    - "test_task_model_validation"
    - "test_repository_save"
    - "test_repository_find_by_id"
    - "test_repository_find_all"
    - "test_repository_delete"
    - "test_repository_persistence"
    - "test_service_create_task"
    - "test_service_get_task"
    - "test_service_list_tasks"
    - "test_service_update_task"
    - "test_service_complete_task"
    - "test_service_delete_task"
    - "test_service_task_not_found"
